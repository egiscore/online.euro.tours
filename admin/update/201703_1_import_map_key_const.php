<?php
 class import_map_key_const extends UpdateModel { public $title = 'Импорт константы MAP_KEY'; public function make() { if (!defined('INTERNET_USER')) { $sql = $this->db->formatExec( $this->OFFICEDB . '.dbo.up_WEB_3_default_usercode' ); $INTERNET_USER = $this->db->fetchOne($sql); } else { $INTERNET_USER = INTERNET_USER; } $params = [ 'Section' => 'online_config', 'What' => 'MAP_KEY', 'UserCode' => $INTERNET_USER, ]; $sql = $this->db->formatExec($this->OFFICEDB . '.dbo.up_WEB_3_ADMIN_tour_config', $params); $currentKey = $this->db->fetchOne($sql); if ($currentKey) { return 0; } $params['Value'] = (defined('MAP_KEY')) ? MAP_KEY : ""; $sql = $this->db->formatExec($this->OFFICEDB . '.dbo.up_WEB_3_ADMIN_tour_config', $params); $this->db->query($sql); return 0; } } 