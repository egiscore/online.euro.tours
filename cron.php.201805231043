<?php
if ('cli' != PHP_SAPI) { ignore_user_abort(true); header('Content-type: image/gif'); echo base64_decode("R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="); flush(); if (function_exists('fastcgi_finish_request')) { fastcgi_finish_request(); } } else { $_SERVER['HTTP_HOST'] = 'localhost'; $_SERVER['REMOTE_ADDR'] = '127.0.0.1'; $_SERVER['DOCUMENT_ROOT'] = __DIR__; if (2 == $argc) { $_GET['task'] = $argv[1]; } chdir($_SERVER['DOCUMENT_ROOT']); } include 'properties.php'; include_once _ROOT . 'includes/classes/class.samo_config.php'; Samo_Debug_Helper::proctitle('background task: crontab'); Samo_Loader::register_autoload(); $tools = Samo_Loader::load_object('Samo_Tools'); $task = (isset($_GET['task']) && !empty($_GET['task'])) ? preg_replace('~[^0-9a-z_]~i', '', $_GET['task']) : null; $tools->crontab($task); 