<?php
 class Agencies_Controller extends Samo_Controller { protected $embeddable = array('default_action'); public function default_action() { $this->view->assign('TOWNS', $this->model->getTOWNS()); $this->view->assign('METROSTATIONS', $this->model->getMETROSTATIONS()); if (isset($_GET['DOLOAD'])) { $this->SEARCH(); } parent::default_action(); } public function TOWN() { $this->view->add_options('METROSTATION', $this->model->getMETROSTATIONS(), '../freight_monitor/controls.tpl'); } public function SEARCH() { $messages = $this->messages; if (false !== ($data = $this->model->search())) { $this->view->assign('AGENCIES', $data)->element_update('resultset', 'resultset.tpl'); } else { $this->view->element_text('resultset', $messages['NO_DATA']); } } public function SHOW() { if (false !== ($data = $this->model->info())) { $this->view ->assign('data', $data) ->popup_close() ->popup_template('3_info.tpl', $data['name'], 800, 500); } else { $messages = Samo_Registry::get('messages'); $this->view->element_text('resultset', $messages['NO_DATA']); } } } 