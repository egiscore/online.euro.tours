<?php
 class All_Prices_Controller extends Samo_Controller { public function construct() { $this->persistent = array('CURRENCY'); } public function default_action() { if (false !== ($catclaimInfo = $this->model->catclaimInfo()) && false !== ($currency = $this->model->getCURRENCY()) && false !== ($checkin = $this->model->getCHECKIN_BEG())) { $view = $this->view; $view->default_modifiers = array(); $view->assign('checkin', $checkin) ->assign('CURRENCY', $currency) ->js_var('samo.CROSS_RATES', $this->model->getCurrencyRates()); $this->prices(); } parent::default_action(); } private function prices() { if (false !== ($catclaimInfo = $this->model->catclaimInfo())) { $this->view->assign('prices', $this->model->getPrices()) ->assign('nights', $this->model->nights()) ->assign('prices_info', $catclaimInfo); } } public function RESULT() { $this->prices(); $this->view->element_update('resultset', 'resultset.tpl'); return true; } } 