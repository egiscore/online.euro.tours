<?php
 class Check_Passport_Model extends Search_Tour_Model { protected $api_name = 'Check_Passport_Api'; public function construct() { $api = $this->api(); $api->getTOWNFROMS(); $api->getSTATES(); $this->townFrom($api->TOWNFROMINC); $this->state($api->STATEINC); $this->defaults['VISAINC'] = null; $this->defaults['CHECKIN'] = ($checkin = Samo_Request::date('CHECKIN', Samo_Datetime::today(), Samo_Datetime::parse('2 year'))) && $checkin->not_null() ? $checkin : Samo_Datetime::parse('tomorrow'); $this->defaults['NIGHTS'] = Samo_Utils::ifs(Samo_Request::intval('NIGHTS'), 7); $this->defaults['CITIZENSHIP'] = Samo_Request::intval('CITIZENSHIP'); $this->defaults['BORNPLACE'] = Samo_Request::intval('BORNPLACE'); $this->defaults['PVALIDDATE'] = Samo_Request::date('PVALIDDATE'); } public function check() { return $this->api()->getResult(); } public function getCITIZENSHIP() { return $this->api()->getCITIZENSHIPS(); } public function getBORNPLACE() { return $this->api()->getBORNPLACES(); } public function getNIGHTS() { $result = []; foreach (range(1, 31) as $night) { $result[] = ['id' => $night, 'name' => $night, $night == $this->defaults['NIGHTS']]; } return $result; } public function getCHECKIN($type = 'CHECKIN_BEG') { return $this->defaults['CHECKIN']; } } 