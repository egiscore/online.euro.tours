<?php
 class Hotel_Stopsale_Controller extends Samo_Controller { public function construct() { $this->actions = array( 'INIT' => array('TOWNFROMINC', 'STATEINC', 'TOWNTO', 'HOTELINC'), 'TOWNFROMINC' => array('STATEINC', 'TOWNTO', 'HOTELINC'), 'STATEINC' => array('TOWNTO', 'HOTELINC'), 'TOWNTO' => array('HOTELINC') ); $this->persistent = array('STATEINC', 'TOWNFROMINC'); } public function default_action() { $this->init_data(); if (Samo_Request::get('DOLOAD')) { $this->loadStopsales(); } parent::default_action(); } public function STOPSALES() { if (false !== ($result = $this->model->getStopsales())) { $this->view->assign('h_stop_sale', $result) ->element_update('resultset', 'resultset.tpl'); } } protected function loadStopsales() { $this->view->assign('lang', $this->messages) ->assign('DOLOAD', true) ->assign('h_stop_sale', $this->model->getStopsales()); } public function samo_action($action) { if (!isset($this->actions[$action])) { Samo_Registry::get('response')->not_found(); } foreach ($this->actions[$action] as $control) { if (false !== ($result = $this->model->loadData($control))) { $this->view->add_options($control, $result, '../api_controls.tpl'); } } return true; } } 