<?php
 class Kkb_Kz_Controller extends Samo_Controller { public function default_action() { Samo_Registry::get('response')->not_found(); } public function CHECK() { try { $this->model->isEnabled(); $this->model->getPaymentInfoForKKBKZ(); foreach ($this->model->defaults['kkb_kz'] as $i => $n) { $this->view->assign('kkb_kz_' . $i, $n); } $this->view ->popup_template('form.tpl', $this->messages['KKB_KZ_POPUP_TITLE'], 360, 80) ->js_var('samo.CLAIM', $this->model->defaults['CLAIM']) ->js_call('samo.kkb_kz'); } catch (Samo_Exception $e) { $this->view->popup_message($e->getMessage(), $this->messages['POPUP_TITLE'], 350, 60); } } public function RESULT() { $status = Samo_Request::get('status'); $this->view->assign('message', $status == 'ok' ? $this->messages['KKB_KZ_RESULT_OK'] : $this->messages['KKB_KZ_RESULT_FAIL'])->assign('status', $status)->render('result'); } public function GET_POST_DATA() { $this->model->isEnabled(); list ($sign, $appendix) = $this->model->getRequestData(); $this->view->element_value('#kkb_kz_signed_order_id', $sign); $this->view->element_value('#kkb_kz_appendix', $appendix); $this->view->element_trigger('#kkb_kz_form', 'submitKKBKZForm'); } } 