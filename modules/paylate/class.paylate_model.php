<?php
 class Paylate_Model extends Samo_Acquiring { protected $moduleName = 'paylate'; public function __construct() { parent::__construct(); $this->bankInc = $this->acquiringConfig('PAYLATE_SAMO_INC'); $this->bankAlias = $this->acquiringConfig('PAYLATE_SAMO_ALIAS'); $this->maxAmount = floatval($this->acquiringConfig('PAYLATE_MAX_AMOUNT')); if (null == $this->bankInc) { throw new Samo_Exception(get_called_class() . ' was not configured', 501); } } public function getHiddenFields() { return array( 'client_id' => $this->acquiringConfig('PAYLATE_CLIENT_ID'), 'order_id' => '', 'category' => 'Travel', 'goods' => '', 'token' => '', 'action' => 'by_partner' ); } public function makeFormData() { $claim = Samo_Request::intval('CLAIM'); $amount = Samo_Request::floatval('amount'); $login = $this->acquiringConfig('PAYLATE_LOGIN'); $password = $this->acquiringConfig('PAYLATE_PASSWORD'); return array( 'order_id' => $claim, 'goods' => json_encode( array( array( 'Name' => 'Claim N' . $claim, 'Price' => $amount, 'Count' => 1 ) ) ), 'token' => md5($login . md5($password) . $claim) ); } public function getFormAction() { return $this->acquiringConfig('PAYLATE_PAY_URL'); } } 