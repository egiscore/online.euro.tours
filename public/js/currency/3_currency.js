'use strict';(function($){samo.currency=function(){var $module_container=$('#currency');$module_container.find('.rate').on('click',function(){var data=$(this).data();$.getScript(samo.ROUTES.currency.url+$.param({samo_action:'history','CURRENCY':data.currency.currency,'CURRENCYBASE':data.currency.base}),function(){if(typeof google=='undefined'){$.require('//www.gstatic.com/charts/loader.js',function(){google.charts.load('43',{packages:['corechart','line'],language:samo.LANG.locale});google.charts.setOnLoadCallback(samo.currency_chart);});}else{samo.currency_chart();}});});var chartTooltip=function(row,value){var $row=$(row);var change=parseFloat($row.find('td:eq(2)').text())||0;return'<div style="padding:5px;">'+'<p style="text-align: center; color: #8E959A;">'+$row.find('td:first').html()+'</p><br />'+'<span style="font-weight: bold">'+value+' '+$row.parents('table:first').data('base')+'</span>'+
(change!=0?' <span style="color: '+(change>0?'green; vertical-align: super':'red; vertical-align: sub')+'; font-size: 10px;">'+(change>0?'+':'')+change+'</span>':'')+'</div>';};samo.currency_chart=function(){var dataTable=new google.visualization.DataTable();var $row=$('#currency-history thead tr').first();dataTable.addColumn('date',$row.find('th:eq(0)').data('title')||$row.find('th:eq(0)').html());dataTable.addColumn('number',$row.find('th:eq(1)').data('title')||$row.find('th:eq(1)').html());dataTable.addColumn({type:'string',role:'tooltip','p':{'html':true}});var values=[];var min=null,max=null,value=null;var $rows=$('#currency-history tbody tr');$rows.each(function(i,v){value=parseFloat($(this).find('td:eq(1)').text());if(min==null||value<min){min=value;}
if(max==null||value>max){max=value;}
dataTable.addRows([[samo.dateFromString($(this).find('td:eq(0)').text(),'dd.mm.yyyy'),value,chartTooltip(this,value)]]);});var diff=(max-min)*0.2;var $chart=$('#currency-chart');var table=new google.visualization.LineChart($chart.get(0));var options={colors:['red'],pointSize:4,titlePosition:'in',axisTitlesPosition:'in',hAxis:{textPosition:'out',slantedText:true,slantedTextAngle:90,gridlines:{count:20},format:'MMM dd'},vAxis:{textPosition:'in',viewWindow:{max:max+diff,min:min-diff},gridlines:{count:15}},chartArea:{backgroundColor:'#F6F9FB',width:'100%',height:'80%',top:0},tooltip:{isHtml:true},legend:'none'};table.draw(dataTable,options);};};$(document).ready(samo.currency);})(samo.jQuery);