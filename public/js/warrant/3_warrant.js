
(function($){samo.warrant=function(){var _ROOT_URL=samo.ROUTES.warrant.url,$module_container=$('#warrant');$('table.res',$module_container).delegate('div.link','click',function(e){var $this=$(this);if(false==$this.hasClass('samo-delayed-download')){var params={};params.samo_action='dover';params.peop=$(this).parent().data('warrant');$(e.target).prop('href',samo.ROUTES.warrant.url+$.param(params)).html('');samo.delayed_download(e);}else if($this.prop('href')){window.location.href=$this.attr('href');}});$('#add_warrant',$module_container).bind('click',function(){var params={};params.samo_action='ADD_WARANT';$.getScript(_ROOT_URL+$.param(params));});samo.warrant_initform=function(){var $warrant=$('#new_warrant');$warrant.find('input.date').datePicker();$warrant.find('input.date[name*=PAYER_BORN]').datePicker({start_date:samo.dateYearAgo(-30)});samo.set_data_mask($warrant);samo.helpalt_field($warrant);$('#WARRANT_FORM').bind('submit',function(e){e.stopPropagation();e.preventDefault();if(check_fields()){$.post(this.action,$(this).serialize(),null,'script');}});};function check_fields(){var is_ok=true;samo.field.clear_errors($('#new_warrant'));$('.required','#new_warrant').not('label').each(function(){if(!$(this).val().length){is_ok=samo.field.error(samo.i18n('REQUIRED_FIELD_EMPTY'),this);return false;}});if(is_ok){$('.date','#new_warrant').each(function(){if(this.value.length&&!$.valid_date(this)){is_ok=samo.field.error(samo.i18n('DATE_FORMAT_TITLE'),this);return false;}});}
return is_ok;}}
$(document).ready(samo.warrant);})(samo.jQuery);