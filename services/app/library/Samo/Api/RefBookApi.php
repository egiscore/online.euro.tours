<?php
 namespace Samo\Api; class RefBookApi extends Api { public function __construct($params) { parent::__construct($params); $this->addPublicMethods(['getStates', 'getCurrencies']); } public function getStates() { $selected = $this->getParam('STATE'); $params = ['UserCode' => $this->settings->getUserCode()]; $query = $this->db->prepare('up_WEB_3_bron_StateBorn', $params, 'SLAVE'); $result = $this->db->resultCollection($query, 'state_born'); foreach ($result as $state) { if ($selected) { $state->selected = false; if ($state->id == $selected) { $state->selected = true; } } } return $result->toArray(); } public function getCurrencies() { $query = $this->db->prepare('up_WEB_3_currency_list', []); return $this->db->resultCollection($query, 'currencies')->toArray('id'); } } 