<?php
 namespace Samo\Config; use Phalcon\Di; use Samo\DB\DB; class TourConfig { public $section; public $userCode = null; public $what = null; public $townFrom = null; public $state = null; public $tour = null; protected $di; protected $db; public function __construct($section) { $this->di = Di::getDefault(); $this->db = $this->di->getDb(); $this->section = $section; } protected function setParams() { return [ 'TownFrom' => $this->townFrom, 'State' => $this->state, 'Tour' => $this->tour, 'Section' => $this->section, 'UserCode' => $this->userCode, 'What' => $this->what ]; } public function result($all = true) { $params = $this->setParams(); $query = $this->db->prepare('up_WEB_3_tour_config', $params); $result = $this->db->resultCollection($query, 'online_tour_config'); return $all ? $result : $result->findFirst(); } } 